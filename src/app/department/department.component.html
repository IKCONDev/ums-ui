<div>
    <app-side-menubar></app-side-menubar>
</div>
<div>
    <app-header [title]="title"></app-header>
</div>

<div class="container-fluid">
    <div class="card-header">
        <div class="row">
            <div class="col-sm-8 d-flex">
                <h3 id="heading">Department</h3>
            </div>
            <div id="addBtnDiv" class="col-sm-1 d-flex">
                <button class="form-control d-flex" id="addBtn" type="submit" data-toggle="modal" data-target="#addModal"
                style="width: 60px;">
                    <p>Add</p>
                </button>
            </div>
            <div id="deleteBtnDiv" class="col-sm-2 d-flex">
                <button type="submit" class=" form-control" id="deleteBtn" name="deleteBtn"
                (click)="removeAllSelectedDepartments()"  style="width: 80px;" >Delete</button>
             </div>
            <!-- <div class="col-sm-1 d-flex" id="filter">
                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none">
                    <path
                        d="M11 18H13C13.55 18 14 17.55 14 17C14 16.45 13.55 16 13 16H11C10.45 16 10 16.45 10 17C10 17.55 10.45 18 11 18ZM3 7C3 7.55 3.45 8 4 8H20C20.55 8 21 7.55 21 7C21 6.45 20.55 6 20 6H4C3.45 6 3 6.45 3 7ZM7 13H17C17.55 13 18 12.55 18 12C18 11.45 17.55 11 17 11H7C6.45 11 6 11.45 6 12C6 12.55 6.45 13 7 13Z"
                        fill="#E5EEF1" />
                </svg>
            </div> -->
        </div>
    </div>
    <div class="card-body">
        <div class="row">
            <table id="table" class="table table-hover">
                <thead id="thead">
                    <tr>
                        <th>
                            <input type="checkbox" id="mainCheckBox" (click)="checkSubCheckBoxes()" />
                        </th>
                        <th>Department ID</th>
                        <th>Department Name</th>
                        <th>Department Code</th>
                        <th>Department Head</th>
                        <th>Department Location</th>
                        <th>Added by</th>
                        <th>Created Date</th>
                        <th>Modified By</th>
                        <th>Modified Date</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="trbody" id="dataRow" *ngFor="let department of departmentList;let i = index">
                        <td>
                            <input type="checkbox" id="subCheckBox{{i}}" class="subCheckBox"
                                value="{{department.departmentId}}" (click)="toggleMainCheckBox(i)" />
                        </td>
                        <td>DEPT{{department.departmentId}}</td>
                        <td>{{department.departmentName | titlecase}}</td>
                        <td>{{department.departmentCode | uppercase}}</td>
                        <td>{{department.departmentHead | titlecase}}</td>
                        <td>{{department.departmentAddress | titlecase}}</td>
                        <td>{{department.createdBy | titlecase}}</td>
                        <td>{{department.createdDateTime |date:'MMM d, y, h:mm a' }}</td>
                        <td>{{department.modifiedBy | titlecase}}</td>
                        <td>{{department.modifiedDateTime |date:'MMM d, y, h:mm a'}}</td>
                        <td>
                            <span id="editIcon" (click)="fetchOneDepartment(department.departmentId)"
                                data-toggle="modal" data-target="#updateModal">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20"
                                    fill="none">
                                    <g id="edit">
                                        <path id="Vector"
                                            d="M2.5 14.3761V17.5007H5.62543L14.8475 8.28116L11.7221 5.15659L2.5 14.3761ZM17.2562 5.87316C17.5813 5.54821 17.5813 5.01911 17.2562 4.69416L15.3101 2.7486C14.9851 2.42364 14.4558 2.42364 14.1308 2.7486L12.6056 4.27339L15.731 7.39795L17.2562 5.87316Z"
                                            fill="#5590AA" />
                                    </g>
                                </svg>
                                &nbsp;
                            </span>
                            <span id="trashIcon" (click)="removeDepartment(department.departmentId)">
                                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
                                    fill="#000000" version="1.1" id="Capa_1" width="15px" height="15px"
                                    viewBox="0 0 482.428 482.429" xml:space="preserve">
                                    <g>
                                        <g>
                                            <path
                                                d="M381.163,57.799h-75.094C302.323,25.316,274.686,0,241.214,0c-33.471,0-61.104,25.315-64.85,57.799h-75.098    c-30.39,0-55.111,24.728-55.111,55.117v2.828c0,23.223,14.46,43.1,34.83,51.199v260.369c0,30.39,24.724,55.117,55.112,55.117    h210.236c30.389,0,55.111-24.729,55.111-55.117V166.944c20.369-8.1,34.83-27.977,34.83-51.199v-2.828    C436.274,82.527,411.551,57.799,381.163,57.799z M241.214,26.139c19.037,0,34.927,13.645,38.443,31.66h-76.879    C206.293,39.783,222.184,26.139,241.214,26.139z M375.305,427.312c0,15.978-13,28.979-28.973,28.979H136.096    c-15.973,0-28.973-13.002-28.973-28.979V170.861h268.182V427.312z M410.135,115.744c0,15.978-13,28.979-28.973,28.979H101.266    c-15.973,0-28.973-13.001-28.973-28.979v-2.828c0-15.978,13-28.979,28.973-28.979h279.897c15.973,0,28.973,13.001,28.973,28.979    V115.744z" />
                                            <path
                                                d="M171.144,422.863c7.218,0,13.069-5.853,13.069-13.068V262.641c0-7.216-5.852-13.07-13.069-13.07    c-7.217,0-13.069,5.854-13.069,13.07v147.154C158.074,417.012,163.926,422.863,171.144,422.863z" />
                                            <path
                                                d="M241.214,422.863c7.218,0,13.07-5.853,13.07-13.068V262.641c0-7.216-5.854-13.07-13.07-13.07    c-7.217,0-13.069,5.854-13.069,13.07v147.154C228.145,417.012,233.996,422.863,241.214,422.863z" />
                                            <path
                                                d="M311.284,422.863c7.217,0,13.068-5.853,13.068-13.068V262.641c0-7.216-5.852-13.07-13.068-13.07    c-7.219,0-13.07,5.854-13.07,13.07v147.154C298.213,417.012,304.067,422.863,311.284,422.863z" />
                                        </g>
                                    </g>
                                </svg>
                            </span>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>

<!-- Add Department Modal -->
<div class="modal fade" id="addModal" data-backdrop="static" data-keyboard="false" tabindex="-1" role="dialog"
    aria-labelledby="xlModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-md">
        <div class="modal-content">
            <!-- Modal Header -->
            <div class="modal-header" id="modalHeader">
                <h5 class="modal-title" id="xlModalLabel">Add Department</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true" style="color:white; padding: 5px; padding-top: 0px;"
                        (click)="clearErrorMessages()">&times;</span>
                </button>
            </div>
            <!-- Modal body -->
            <div class="modal-body">
                <label><b>Department Name</b><span id="required">*</span></label>
                <input type="text" style="text-transform: capitalize;" class="deptInput form-control" placeholder="Department name"
                    [(ngModel)]="addDepartment.departmentName" (keyup)="validateDepartmentName()" minlength="3"
                    maxlength="50" /><br />
                <span *ngIf="departmentNameErrorInfo != ''">
                    <p id="errorMessage">{{departmentNameErrorInfo}}</p>
                </span>
                <!--   -->
                <label><b>Department Head</b><span id="required">*</span></label>
                <ng-select id="deptHead" style="text-transform: capitalize;" placeholder="Department head"
                    [(ngModel)]="addDepartment.departmentHead" (keyup)="validateDepartmentHead()"  minlength="3" maxlength="50">
                   <ng-option *ngFor="let deptHead of employeesAsUser" value="{{deptHead.email}}">{{deptHead.firstName}} {{deptHead.lastName}}</ng-option>
                </ng-select><br />
                <span *ngIf="departmentHeadErrorInfo != ''">
                    <p id="errorMessage">{{departmentHeadErrorInfo}}</p>
                </span>
                <!--  -->
                <label><b>Department Code</b><span id="required">*</span></label>
                <input type="text"  id="departmentCode" style="text-transform: uppercase;" class="deptInput form-control" placeholder="Department Code"
                    [(ngModel)]="addDepartment.departmentCode" (keyup)="validateDepartmentCode()" minlength="1"
                    maxlength="10" /><br />
                <span *ngIf="departmentCodeErrorInfo != ''">
                    <p id="errorMessage">{{departmentCodeErrorInfo}}</p>
                </span>
                <!--  -->
                <label><b>Department Location</b><span id="required">*</span></label>
                <input type="text" style="text-transform: capitalize;" class="deptInput form-control" placeholder="Department location"
                    [(ngModel)]="addDepartment.departmentAddress" (keyup)="validateDepartmentLocation()" minlength="3"
                    maxlength="20" />
                <span *ngIf="departmentLocationErrorInfo != ''">
                    <p id="errorMessage">{{departmentLocationErrorInfo}}</p>
                </span>
                <!--  -->
            </div>
            <!-- Modal footer -->
            <div class="modal-footer" role="alert">
                <button type="submit" class="btn btn-primary saveButton" (click)="createDepartment()">Save</button>
                <!-- <button type="button" class="btn btn-secondary" data-dismiss="modal"
                        (click)=" clearErrorMessages(form)">Close</button> -->
                <button type="button" id="closeAddModal" class="btn btn-outline-danger closeButton" data-dismiss="modal"
                    (click)="clearErrorMessages()">Close</button>
            </div>
        </div>
    </div>
</div>


<!-- Update Department Modal -->
<div class="modal fade" id="updateModal" data-backdrop="static" data-keyboard="false" tabindex="-1" role="dialog"
    aria-labelledby="xlModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-md">
        <div class="modal-content">
            <!-- Modal Header -->
            <div class="modal-header" id="modalHeader">
                <h5 class="modal-title" id="xlModalLabel">Update Department</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true" style="color:white; padding: 5px; padding-top: 0px;"
                        (click)="clearErrorMessages()">&times;</span>
                </button>
            </div>
            <!-- Modal body -->
            <div class="modal-body">
                <label><b>Department Name</b><span id="required">*</span></label>
                <input type="text" style="text-transform: capitalize;" class="deptInput form-control" placeholder="Department name"
                    [(ngModel)]="existingDepartment.departmentName" (keyup)="validateUpdatedDepartmentName()"
                    minlength="3" maxlength="50" /><br />
                <span *ngIf="updatedDepartmentNameErrorInfo != ''">
                    <p id="errorMessage">{{updatedDepartmentNameErrorInfo}}</p>
                </span>
                <!--   -->
                <label><b>Department Head</b><span id="required">*</span></label>
                <ng-select type="search" style="text-transform: capitalize;" id="updateDeptHead" placeholder="Department head"
                    [(ngModel)]="existingDepartment.departmentHead" (keyup)="validateUpdatedDepartmentHead()" 
                    minlength="3" maxlength="50" placeholder="Department head">
                    <ng-option *ngFor="let deptHead of employeesAsUser" value="{{deptHead.email}}">{{deptHead.firstName}} {{deptHead.lastName}}</ng-option>
                </ng-select><br />
                <span *ngIf="updatedDepartmentHeadErrorInfo != ''">
                    <p id="errorMessage">{{updatedDepartmentHeadErrorInfo}}</p>
                </span>
                <!--  -->
                <label><b>Department Code</b><span id="required">*</span></label>
                <input type="text" id="departmentCode" style="text-transform: uppercase;" class="deptInput form-control" placeholder="Department Code"
                    [(ngModel)]="existingDepartment.departmentCode" (keyup)="validateUpdatedDepartmentCode()"
                    minlength="1" maxlength="10" /><br />
                <span *ngIf="updatedDepartmentCodeErrorInfo != ''">
                    <p id="errorMessage">{{updatedDepartmentCodeErrorInfo}}</p>
                </span>
                <!--  -->
                <label><b>Department Location</b><span id="required">*</span></label>
                <input type="text" style="text-transform: capitalize;" class="deptInput form-control" placeholder="Department location"
                    [(ngModel)]="existingDepartment.departmentAddress" (keyup)="validateUpdatedDepartmentLocation()"
                    minlength="3" maxlength="20" />
                <span *ngIf="updatedDepartmentLocationErrorInfo != ''">
                    <p id="errorMessage">{{updatedDepartmentLocationErrorInfo}}</p>
                </span>
                <!--  -->
            </div>
            <!-- Modal footer -->
            <div class="modal-footer" role="alert">
                <button type="submit" class="btn btn-primary saveButton" (click)="modifyDepartment()">Save</button>
                <!-- <button type="button" class="btn btn-secondary" data-dismiss="modal"
                        (click)=" clearErrorMessages(form)">Close</button> -->
                <button type="button" id="closeUpdateModal" class="btn btn-outline-danger closeButton"
                    data-dismiss="modal" (click)="clearErrorMessages()">Close</button>
            </div>
        </div>
    </div>
</div>