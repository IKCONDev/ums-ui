<div>
    <app-side-menubar></app-side-menubar>
</div>
<div>
    <app-header [title]="title"></app-header>
</div>
<div class="container-fluid" *ngIf="viewPermission === true">
    <div class="card-body">
        <div *ngIf="reportType === 'department'">
            <div class="row">
                <div class="col-sm-2" style="margin-left: 100px;">
                    <ng-select id="select" [(ngModel)]="selectedDepartment" style="float: right; width: 250px;"
                                placeholder="Choose" (change)="chooseDepartment()">
                                <ng-option *ngFor="let department of departmentList"
                                    value="{{department.departmentId}}">{{department.departmentName}}</ng-option>
                            </ng-select>
               </div>
            </div>
            <br/>
            <div class="row">
                
                <div class="col-sm-5" style="margin-left: 50px;">
                    <div class="card">
                        <div class="card-header" style="background-color: #134E69D9;">
                            <h4 style="text-align: center;color: white;">Report Summary</h4>
                        </div>
                        <div style="margin-left: 30px;margin-top: 20px;">
                        <p>Report Module : <b>Meetings</b></p>
                        <p>Department ID : <b>{{selectedDepartment}}</b></p>
                        <p>Department Name : <b>{{selectedDepartmentName}}</b></p>
                        <p>Total Meetings of the Department : <b>{{meetingsByDepartmentListCount}}</b></p>
                        </div>
                    </div>
                </div>
                <div class="col-sm-6">
                    <div class="card">
                        <div class="card-header" id="header">
                            <h4 id="reportheading">Meetings</h4>
                            <div  class="col-sm-6" id="chartType">
                            <!-- <a style="color: white;" (click)="setChartType('pie')">Pie</a>
                            <a style="color: white;" (click)="setChartType('bar')">Bar</a>
                            <a style="color: white;" (click)="setChartType('line')">Line</a>
                            <a style="color: white;" (click)="setChartType('doughnut')">Doughnut</a> -->
                            <span  (click)="setChartType('line')"><svg width="48" height="24" viewBox="0 0 683 683" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <g clip-path="url(#clip0_4340_105478)">
                                <path [style.fill]="colorOfChartType==='line' ? '#FFFFAA' : '#fff'" d="M0 341.334V639.667C0 663.415 19.2518 682.667 43 682.667H341.333H648.667C667.444 682.667 682.667 667.445 682.667 648.667C682.667 629.889 667.444 614.667 648.667 614.667H375.333H68V307.334V34.0004C68 15.2227 52.7777 0.000305176 34 0.000305176C15.2223 0.000305176 0 15.2226 0 34.0003V341.334Z" fill="white"/>
                                <path [style.fill]="colorOfChartType==='line' ? '#A0E7E5' : '#fff'" d="M573.599 232.4L511.999 294L477.733 259.6L443.333 225.334L392.399 276.267L341.333 327.334L307.333 293.334L273.333 259.334L205.066 327.6L159.999 372.667C147.113 385.554 147.113 406.447 159.999 419.334C173.605 432.939 195.395 432.603 209.188 419.187C215.384 413.161 222.352 406.315 229.599 399.067L273.333 355.334L307.333 389.334L341.333 423.334L392.666 372L443.999 320.667L477.999 354.667L511.999 388.667L597.333 303.334L658.933 241.734C672.04 228.626 672.04 207.375 658.933 194.267C645.899 181.233 624.767 181.233 611.733 194.267L573.599 232.4Z" fill="white"/>
                                </g>
                                <defs>
                                <clipPath id="clip0_4340_105478">
                                <rect width="682.667" height="682.667" fill="white"/>
                                </clipPath>
                                </defs>
                                </svg>
                            </span>
                            <span   (click)="setChartType('bar')"><svg version="1.0" xmlns="http://www.w3.org/2000/svg"
                                width="48" height="24" viewBox="0 0 312 512.000000"
                                preserveAspectRatio="xMidYMid meet">
        
                                <g  transform="translate(0.000000,512.000000) scale(0.100000,-0.100000)"
                                fill="#000000" stroke="none">
                                <path [style.fill]="colorOfChartType==='bar' ? '#FFFFAA' : '#fff'" d="M0 2118 c0 -1342 3 -1945 11 -1972 14 -50 82 -118 135 -134 32 -9
                                585 -12 2508 -12 l2466 0 0 215 0 215 -2345 0 -2345 0 0 1810 0 1810 -215 0
                                -215 0 0 -1932z"/>
                                <path [style.fill]="colorOfChartType==='bar' ? '#FFAEBC' : '#fff'" d="M3965 4033 c-47 -24 -86 -64 -106 -108 -18 -38 -19 -105 -19 -1662
                                l0 -1623 535 0 535 0 -2 1627 -3 1628 -22 40 c-27 50 -58 80 -105 100 -56 23
                                -768 22 -813 -2z"/>
                                <path [style.fill]="colorOfChartType==='bar' ? '#B4F8C8' : '#fff'" d="M2480 3184 c-45 -20 -87 -59 -111 -106 -18 -36 -19 -76 -19 -1238 l0
                                -1200 530 0 530 0 0 1200 c0 1162 -1 1202 -19 1238 -25 48 -66 87 -113 106
                                -55 23 -745 23 -798 0z"/>
                                <path  [style.fill]="colorOfChartType==='bar' ? '#A0E7E5' : '#fff'" d="M1008 2338 c-21 -5 -58 -28 -82 -50 -79 -68 -76 -37 -76 -895 l0
                                -753 535 0 535 0 0 769 0 769 -28 53 c-20 39 -41 62 -77 84 l-48 30 -361 2
                                c-219 1 -376 -2 -398 -9z"/>
                                </g>
                                </svg>
                            </span>
                            <span  (click)="setChartType('pie')"><svg version="1.0" xmlns="http://www.w3.org/2000/svg"
                                width="42" height="22" viewBox="0 0 512.000000 512.000000"
                                preserveAspectRatio="xMidYMid meet">
                               
                               <g  transform="translate(0.000000,512.000000) scale(0.100000,-0.100000)"
                               fill="#000000" stroke="none">
                               <path [style.fill]="colorOfChartType==='pie' ? '#FFFFAA' : '#fff'" d="M2241 5104 c-885 -113 -1654 -686 -2021 -1504 -90 -201 -169 -482
                               -202 -720 -20 -145 -16 -527 6 -675 23 -151 83 -391 131 -521 85 -231 235
                               -500 393 -703 81 -105 310 -336 412 -417 203 -160 492 -324 721 -408 468 -172
                               1007 -201 1494 -80 384 95 764 290 1055 542 l35 31 -917 918 c-516 517 -922
                               930 -928 946 -7 19 -10 445 -10 1318 l0 1289 -32 -1 c-18 -1 -80 -7 -137 -15z"/>
                               <path [style.fill]="colorOfChartType==='pie' ? '#FFAEBC' : '#fff'" d="M2710 3915 l0 -1205 1205 0 c960 0 1205 3 1205 13 0 48 -34 286 -54
                               379 -200 920 -900 1668 -1798 1922 -167 48 -437 95 -540 96 -17 0 -18 -64 -18
                               -1205z"/>
                               <path [style.fill]="colorOfChartType==='pie' ? '#B4F8C8' : '#fff'" d="M3700 1635 l775 -776 28 33 c16 18 61 76 101 128 294 388 462 824
                               511 1323 l7 67 -1099 0 -1098 0 775 -775z"/>
                               </g>
                               </svg>
                            </span>
                            <span (click)="setChartType('doughnut')"><svg width="42" height="22" viewBox="0 0 683 683" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <g clip-path="url(#clip0_4340_105482)">
                                <path [style.fill]="colorOfChartType==='doughnut' ? '#FFAEBC' : '#fff'"  d="M29.3329 202.667C78.2662 93.6003 180.8 17.2003 298.8 2.13361C306.4 1.06696 314.666 0.266968 317.066 0.133606L321.333 0.000305176V77.5C179.407 88.6804 73.7317 205.261 76.5 347.6C79.2182 487.362 183.155 598.664 322.666 607.467C401.558 612.445 514 541.408 514 541.408L568.666 596.134L564 600.267C525.2 633.867 474.533 659.867 423.333 672.534C358.4 688.667 286.533 684.8 224.133 661.867C193.6 650.667 155.066 628.8 128 607.467C114.4 596.667 83.8662 565.867 73.0662 551.867C51.9995 524.8 31.9995 488.934 20.6662 458.134C14.2662 440.8 6.26618 408.8 3.19952 388.667C0.266184 368.934 -0.267149 318 2.39952 298.667C6.79952 266.934 17.3329 229.467 29.3329 202.667Z" fill="white"/>
                                <path [style.fill]="colorOfChartType==='doughnut' ? '#A0E7E5' : '#fff'" d="M682.665 319.601C682.665 320.588 664.756 321.063 603.5 321.244C597.867 252.751 578.893 210.436 531.5 160.667C480.735 107.359 434.748 85.4179 361.373 79.5C361.495 5.18433 361.965 0.000640869 363.732 0.000640869C377.465 0.133972 413.465 6.40063 435.732 12.8006C555.465 46.6673 648.799 146.401 675.465 269.067C678.132 281.467 682.665 313.201 682.665 319.601Z" fill="white"/>
                                <path [style.fill]="colorOfChartType==='doughnut' ? '#FFFFAA' : '#fff'" d="M603 361.334H682.933L682 370.267C675.467 436.8 653.067 494.934 613.867 546.667C608.533 553.6 602.533 561.334 600.4 563.734L596.667 568.134L540.605 512C563.428 486.196 574.037 468.783 586.5 436.667C597.396 408.59 601.162 391.394 603 361.334Z" fill="white"/>
                                </g>
                                <defs>
                                <clipPath id="clip0_4340_105482">
                                <rect width="682.667" height="682.667" fill="white"/>
                                </clipPath>
                                </defs>
                                </svg>
                            </span>
                           
                            
                        </div>
                        </div>
                        <div class="chart">
                            <div style="padding-top: 6px;"></div>
                            <!-- <ng-select id="select" [(ngModel)]="selectedDepartment" style="float: right; width: 250px;"
                                placeholder="choose" (change)="chooseDepartment()">
                                <ng-option *ngFor="let department of departmentList"
                                    value="{{department.departmentId}}">{{department.departmentName}}</ng-option>
                            </ng-select> -->
                            <canvas id="meetingsByDepartmentListChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
            <br/>
            <table class="table table-hover" *ngIf="meetingsByDepartmentListCount > 0; else noDeptMeetings">
                <thead>
                    <tr >
                        <th>ID</th>
                        <th>Title</th>
                        <th>Organizer</th>
                        <th>Start Date & Time</th>
                        <th>End Date & Time</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let meeting of meetingsByDepartmentList">
                        <td>{{meeting.meetingId}}</td>
                        <td>{{meeting.subject}}</td>
                        <td>{{meeting.organizerName}}</td>
                        <td>{{meeting.startDateTime+'z'|date:'MMM d, y, h:mm a'}}</td>
                        <td>{{meeting.endDateTime+'z'|date:'MMM d, y, h:mm a'}}</td>
                    </tr>
                </tbody>
            </table>
            <ng-template #noDeptMeetings>
                <table class="table table-hover">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Title</th>
                            <th>Organizer</th>
                            <th>Start Date & Time</th>
                            <th>End Date & Time</th>
                        </tr>
                    </thead>
                    <tbody>
                </table>
                <p style="text-align: center;"><b>No Meetings from this department !</b></p>
               </ng-template>
        </div>
        <div *ngIf="reportType === 'employee'">
            <div class="row">
             <div class="col-sm-2" style="margin-left: 136px;margin-top: 10px;">
                <ng-select id="select" [(ngModel)]="selectedEmployee" style="float: right; width: 250px;  margin-left: 0px;"
                                placeholder="Choose" (change)="chooseEmployee()">
                                <ng-option *ngFor="let employee of employeeListAsUser"
                                    value="{{employee.email}}">{{employee.firstName}} {{employee.lastName}}</ng-option>
                </ng-select>
            </div>
            </div>
            <br/>
            <div class="row">
                <div class="col-sm-5" style="margin-left: 51px;">
                    <div class="card">
                        <div class="card-header" style="background-color: #134E69D9;">
                            <h4 style="text-align: center;color: white;">Report Summary</h4>
                        </div>
                        <div style="margin-left: 30px;margin-top: 20px;">
                        <p>Report Module : <b>Meetings</b></p>
                        <!-- <p>Organizer Name : <b>{{selectedEmployee}}</b></p> -->
                        <p>Organizer Email ID : <b>{{selectedEmployee}}</b></p>
                        <p>Total Meetings Organized : <b>{{organizedMeetingListCount}}</b></p>
                        </div>
                    </div>
                </div>
                <div class="col-sm-6">
                    <div class="card">
                        <div class="card-header" id="header">
                            <h4 id="reportheading">Meetings</h4>
                            <div  class="col-sm-6" id="chartType">
                                <!-- <a style="color: white;" (click)="setChartType('pie')">Pie</a>
                                <a style="color: white;" (click)="setChartType('bar')">Bar</a>
                                <a style="color: white;" (click)="setChartType('line')">Line</a>
                                <a style="color: white;" (click)="setChartType('doughnut')">Doughnut</a> -->
                                <span  (click)="setChartType('line')"><svg width="48" height="24" viewBox="0 0 683 683" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <g clip-path="url(#clip0_4340_105478)">
                                    <path [style.fill]="colorOfChartType==='line' ? '#FFFFAA' : '#fff'" d="M0 341.334V639.667C0 663.415 19.2518 682.667 43 682.667H341.333H648.667C667.444 682.667 682.667 667.445 682.667 648.667C682.667 629.889 667.444 614.667 648.667 614.667H375.333H68V307.334V34.0004C68 15.2227 52.7777 0.000305176 34 0.000305176C15.2223 0.000305176 0 15.2226 0 34.0003V341.334Z" fill="white"/>
                                    <path [style.fill]="colorOfChartType==='line' ? '#A0E7E5' : '#fff'" d="M573.599 232.4L511.999 294L477.733 259.6L443.333 225.334L392.399 276.267L341.333 327.334L307.333 293.334L273.333 259.334L205.066 327.6L159.999 372.667C147.113 385.554 147.113 406.447 159.999 419.334C173.605 432.939 195.395 432.603 209.188 419.187C215.384 413.161 222.352 406.315 229.599 399.067L273.333 355.334L307.333 389.334L341.333 423.334L392.666 372L443.999 320.667L477.999 354.667L511.999 388.667L597.333 303.334L658.933 241.734C672.04 228.626 672.04 207.375 658.933 194.267C645.899 181.233 624.767 181.233 611.733 194.267L573.599 232.4Z" fill="white"/>
                                    </g>
                                    <defs>
                                    <clipPath id="clip0_4340_105478">
                                    <rect width="682.667" height="682.667" fill="white"/>
                                    </clipPath>
                                    </defs>
                                    </svg>
                                </span>
                                <span   (click)="setChartType('bar')"><svg version="1.0" xmlns="http://www.w3.org/2000/svg"
                                    width="48" height="24" viewBox="0 0 312 512.000000"
                                    preserveAspectRatio="xMidYMid meet">
            
                                    <g  transform="translate(0.000000,512.000000) scale(0.100000,-0.100000)"
                                    fill="#000000" stroke="none">
                                    <path [style.fill]="colorOfChartType==='bar' ? '#FFFFAA' : '#fff'" d="M0 2118 c0 -1342 3 -1945 11 -1972 14 -50 82 -118 135 -134 32 -9
                                    585 -12 2508 -12 l2466 0 0 215 0 215 -2345 0 -2345 0 0 1810 0 1810 -215 0
                                    -215 0 0 -1932z"/>
                                    <path [style.fill]="colorOfChartType==='bar' ? '#FFAEBC' : '#fff'" d="M3965 4033 c-47 -24 -86 -64 -106 -108 -18 -38 -19 -105 -19 -1662
                                    l0 -1623 535 0 535 0 -2 1627 -3 1628 -22 40 c-27 50 -58 80 -105 100 -56 23
                                    -768 22 -813 -2z"/>
                                    <path [style.fill]="colorOfChartType==='bar' ? '#B4F8C8' : '#fff'" d="M2480 3184 c-45 -20 -87 -59 -111 -106 -18 -36 -19 -76 -19 -1238 l0
                                    -1200 530 0 530 0 0 1200 c0 1162 -1 1202 -19 1238 -25 48 -66 87 -113 106
                                    -55 23 -745 23 -798 0z"/>
                                    <path  [style.fill]="colorOfChartType==='bar' ? '#A0E7E5' : '#fff'" d="M1008 2338 c-21 -5 -58 -28 -82 -50 -79 -68 -76 -37 -76 -895 l0
                                    -753 535 0 535 0 0 769 0 769 -28 53 c-20 39 -41 62 -77 84 l-48 30 -361 2
                                    c-219 1 -376 -2 -398 -9z"/>
                                    </g>
                                    </svg>
                                </span>
                                <span  (click)="setChartType('pie')"><svg version="1.0" xmlns="http://www.w3.org/2000/svg"
                                    width="42" height="22" viewBox="0 0 512.000000 512.000000"
                                    preserveAspectRatio="xMidYMid meet">
                                   
                                   <g  transform="translate(0.000000,512.000000) scale(0.100000,-0.100000)"
                                   fill="#000000" stroke="none">
                                   <path [style.fill]="colorOfChartType==='pie' ? '#FFFFAA' : '#fff'" d="M2241 5104 c-885 -113 -1654 -686 -2021 -1504 -90 -201 -169 -482
                                   -202 -720 -20 -145 -16 -527 6 -675 23 -151 83 -391 131 -521 85 -231 235
                                   -500 393 -703 81 -105 310 -336 412 -417 203 -160 492 -324 721 -408 468 -172
                                   1007 -201 1494 -80 384 95 764 290 1055 542 l35 31 -917 918 c-516 517 -922
                                   930 -928 946 -7 19 -10 445 -10 1318 l0 1289 -32 -1 c-18 -1 -80 -7 -137 -15z"/>
                                   <path [style.fill]="colorOfChartType==='pie' ? '#FFAEBC' : '#fff'" d="M2710 3915 l0 -1205 1205 0 c960 0 1205 3 1205 13 0 48 -34 286 -54
                                   379 -200 920 -900 1668 -1798 1922 -167 48 -437 95 -540 96 -17 0 -18 -64 -18
                                   -1205z"/>
                                   <path [style.fill]="colorOfChartType==='pie' ? '#B4F8C8' : '#fff'" d="M3700 1635 l775 -776 28 33 c16 18 61 76 101 128 294 388 462 824
                                   511 1323 l7 67 -1099 0 -1098 0 775 -775z"/>
                                   </g>
                                   </svg>
                                </span>
                                <span (click)="setChartType('doughnut')"><svg width="42" height="22" viewBox="0 0 683 683" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <g clip-path="url(#clip0_4340_105482)">
                                    <path [style.fill]="colorOfChartType==='doughnut' ? '#FFAEBC' : '#fff'"  d="M29.3329 202.667C78.2662 93.6003 180.8 17.2003 298.8 2.13361C306.4 1.06696 314.666 0.266968 317.066 0.133606L321.333 0.000305176V77.5C179.407 88.6804 73.7317 205.261 76.5 347.6C79.2182 487.362 183.155 598.664 322.666 607.467C401.558 612.445 514 541.408 514 541.408L568.666 596.134L564 600.267C525.2 633.867 474.533 659.867 423.333 672.534C358.4 688.667 286.533 684.8 224.133 661.867C193.6 650.667 155.066 628.8 128 607.467C114.4 596.667 83.8662 565.867 73.0662 551.867C51.9995 524.8 31.9995 488.934 20.6662 458.134C14.2662 440.8 6.26618 408.8 3.19952 388.667C0.266184 368.934 -0.267149 318 2.39952 298.667C6.79952 266.934 17.3329 229.467 29.3329 202.667Z" fill="white"/>
                                    <path [style.fill]="colorOfChartType==='doughnut' ? '#A0E7E5' : '#fff'" d="M682.665 319.601C682.665 320.588 664.756 321.063 603.5 321.244C597.867 252.751 578.893 210.436 531.5 160.667C480.735 107.359 434.748 85.4179 361.373 79.5C361.495 5.18433 361.965 0.000640869 363.732 0.000640869C377.465 0.133972 413.465 6.40063 435.732 12.8006C555.465 46.6673 648.799 146.401 675.465 269.067C678.132 281.467 682.665 313.201 682.665 319.601Z" fill="white"/>
                                    <path [style.fill]="colorOfChartType==='doughnut' ? '#FFFFAA' : '#fff'" d="M603 361.334H682.933L682 370.267C675.467 436.8 653.067 494.934 613.867 546.667C608.533 553.6 602.533 561.334 600.4 563.734L596.667 568.134L540.605 512C563.428 486.196 574.037 468.783 586.5 436.667C597.396 408.59 601.162 391.394 603 361.334Z" fill="white"/>
                                    </g>
                                    <defs>
                                    <clipPath id="clip0_4340_105482">
                                    <rect width="682.667" height="682.667" fill="white"/>
                                    </clipPath>
                                    </defs>
                                    </svg>
                                </span>
                                
                         </div>
                        </div>
                        <div class="chart">
                            <div style="padding-top: 6px;"></div>
                             <!-- <ng-select id="select" [(ngModel)]="selectedEmployee" style="float: right; width: 250px;"
                                placeholder="choose" (change)="chooseEmployee()">
                                <ng-option *ngFor="let employee of employeeListAsUser"
                                    value="{{employee.email}}">{{employee.firstName}} {{employee.lastName}}</ng-option>
                            </ng-select>  -->
                            <canvas id="organizedmeetingListChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
            <br />
            <table class="table table-hover" *ngIf="organizedMeetingListCount > 0; else noOrgMeetings">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Title</th>
                        <th>Organizer</th>
                        <th>Start Date & Time</th>
                        <th>End Date & Time</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let meeting of organizedMeetingList">
                        <td>{{meeting.meetingId}}</td>
                        <td>{{meeting.subject}}</td>
                        <td>{{meeting.organizerName}}</td>
                        <td>{{meeting.startDateTime+'z'|date:'MMM d, y, h:mm a'}}</td>
                        <td>{{meeting.endDateTime+'z'|date:'MMM d, y, h:mm a'}}</td>
                    </tr>
                </tbody>
            </table>
            <ng-template #noOrgMeetings>
                <table class="table table-hover">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Title</th>
                            <th>Organizer</th>
                            <th>Start Date & Time</th>
                            <th>End Date & Time</th>
                        </tr>
                    </thead>
                    <tbody>
                </table>
                <p style="text-align: center;"><b>No Meetings organized !</b></p>
               </ng-template>
        </div>
    </div>
    <div *ngIf="reportType === 'attended'">
        <div class="row">
            <div class="col-sm-2" style="margin-left: 136px;margin-top: 10px;">
                <ng-select id="select" [(ngModel)]="selectedAttendeeUser" style="float: right; width: 250px;"
                placeholder="Choose" (change)="chooseAttendedMeetingUser()">
                <ng-option *ngFor="let employee of employeeListAsUser"
                    value="{{employee.email}}">{{employee.firstName}} {{employee.lastName}}</ng-option>
               </ng-select> 
            </div>
        </div>
        <br/>
        <div class="row">
            <div class="col-sm-5" style="margin-left: 51px;">
                <div class="card">
                    <div class="card-header" style="background-color: #134E69D9;">
                        <h4 style="text-align: center;color: white;">Report Summary</h4>
                    </div>
                    <div style="margin-left: 30px;margin-top: 20px;">
                    <p>Report Module : <b>Meetings</b></p>
                    <!-- <p>Report Type : <b>Bar</b></p> -->
                    <!-- <p>Attendee Name : <b>{{}}</b></p> -->
                    <p>Attendee Email ID : <b>{{selectedAttendeeUser}}</b></p>
                    <p>Total Meetings Attended : <b>{{attendedMeetingListCount}}</b></p>
                    </div>
                </div>
            </div>
            <div class="col-sm-6">
                <div class="card">
                    <div class="card-header" id="header">
                        <h4 id="reportheading">Meetings</h4>
                        <div class="col-sm-6" id="chartType">
                            <!-- <a style="color: white;" (click)="setChartType('pie')">Pie</a>
                            <a style="color: white;" (click)="setChartType('bar')">Bar</a>
                            <a style="color: white;" (click)="setChartType('line')">Line</a>
                            <a style="color: white;" (click)="setChartType('doughnut')">Doughnut</a> -->
                            <span  (click)="setChartType('line')"><svg width="48" height="24" viewBox="0 0 683 683" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <g clip-path="url(#clip0_4340_105478)">
                                <path [style.fill]="colorOfChartType==='line' ? '#FFFFAA' : '#fff'" d="M0 341.334V639.667C0 663.415 19.2518 682.667 43 682.667H341.333H648.667C667.444 682.667 682.667 667.445 682.667 648.667C682.667 629.889 667.444 614.667 648.667 614.667H375.333H68V307.334V34.0004C68 15.2227 52.7777 0.000305176 34 0.000305176C15.2223 0.000305176 0 15.2226 0 34.0003V341.334Z" fill="white"/>
                                <path [style.fill]="colorOfChartType==='line' ? '#A0E7E5' : '#fff'" d="M573.599 232.4L511.999 294L477.733 259.6L443.333 225.334L392.399 276.267L341.333 327.334L307.333 293.334L273.333 259.334L205.066 327.6L159.999 372.667C147.113 385.554 147.113 406.447 159.999 419.334C173.605 432.939 195.395 432.603 209.188 419.187C215.384 413.161 222.352 406.315 229.599 399.067L273.333 355.334L307.333 389.334L341.333 423.334L392.666 372L443.999 320.667L477.999 354.667L511.999 388.667L597.333 303.334L658.933 241.734C672.04 228.626 672.04 207.375 658.933 194.267C645.899 181.233 624.767 181.233 611.733 194.267L573.599 232.4Z" fill="white"/>
                                </g>
                                <defs>
                                <clipPath id="clip0_4340_105478">
                                <rect width="682.667" height="682.667" fill="white"/>
                                </clipPath>
                                </defs>
                                </svg>
                            </span>
                            <span   (click)="setChartType('bar')"><svg version="1.0" xmlns="http://www.w3.org/2000/svg"
                                width="48" height="24" viewBox="0 0 312 512.000000"
                                preserveAspectRatio="xMidYMid meet">
        
                                <g  transform="translate(0.000000,512.000000) scale(0.100000,-0.100000)"
                                fill="#000000" stroke="none">
                                <path [style.fill]="colorOfChartType==='bar' ? '#FFFFAA' : '#fff'" d="M0 2118 c0 -1342 3 -1945 11 -1972 14 -50 82 -118 135 -134 32 -9
                                585 -12 2508 -12 l2466 0 0 215 0 215 -2345 0 -2345 0 0 1810 0 1810 -215 0
                                -215 0 0 -1932z"/>
                                <path [style.fill]="colorOfChartType==='bar' ? '#FFAEBC' : '#fff'" d="M3965 4033 c-47 -24 -86 -64 -106 -108 -18 -38 -19 -105 -19 -1662
                                l0 -1623 535 0 535 0 -2 1627 -3 1628 -22 40 c-27 50 -58 80 -105 100 -56 23
                                -768 22 -813 -2z"/>
                                <path [style.fill]="colorOfChartType==='bar' ? '#B4F8C8' : '#fff'" d="M2480 3184 c-45 -20 -87 -59 -111 -106 -18 -36 -19 -76 -19 -1238 l0
                                -1200 530 0 530 0 0 1200 c0 1162 -1 1202 -19 1238 -25 48 -66 87 -113 106
                                -55 23 -745 23 -798 0z"/>
                                <path  [style.fill]="colorOfChartType==='bar' ? '#A0E7E5' : '#fff'" d="M1008 2338 c-21 -5 -58 -28 -82 -50 -79 -68 -76 -37 -76 -895 l0
                                -753 535 0 535 0 0 769 0 769 -28 53 c-20 39 -41 62 -77 84 l-48 30 -361 2
                                c-219 1 -376 -2 -398 -9z"/>
                                </g>
                                </svg>
                            </span>
                            <span  (click)="setChartType('pie')"><svg version="1.0" xmlns="http://www.w3.org/2000/svg"
                                width="42" height="22" viewBox="0 0 512.000000 512.000000"
                                preserveAspectRatio="xMidYMid meet">
                               
                               <g  transform="translate(0.000000,512.000000) scale(0.100000,-0.100000)"
                               fill="#000000" stroke="none">
                               <path [style.fill]="colorOfChartType==='pie' ? '#FFFFAA' : '#fff'" d="M2241 5104 c-885 -113 -1654 -686 -2021 -1504 -90 -201 -169 -482
                               -202 -720 -20 -145 -16 -527 6 -675 23 -151 83 -391 131 -521 85 -231 235
                               -500 393 -703 81 -105 310 -336 412 -417 203 -160 492 -324 721 -408 468 -172
                               1007 -201 1494 -80 384 95 764 290 1055 542 l35 31 -917 918 c-516 517 -922
                               930 -928 946 -7 19 -10 445 -10 1318 l0 1289 -32 -1 c-18 -1 -80 -7 -137 -15z"/>
                               <path [style.fill]="colorOfChartType==='pie' ? '#FFAEBC' : '#fff'" d="M2710 3915 l0 -1205 1205 0 c960 0 1205 3 1205 13 0 48 -34 286 -54
                               379 -200 920 -900 1668 -1798 1922 -167 48 -437 95 -540 96 -17 0 -18 -64 -18
                               -1205z"/>
                               <path [style.fill]="colorOfChartType==='pie' ? '#B4F8C8' : '#fff'" d="M3700 1635 l775 -776 28 33 c16 18 61 76 101 128 294 388 462 824
                               511 1323 l7 67 -1099 0 -1098 0 775 -775z"/>
                               </g>
                               </svg>
                            </span>
                            <span (click)="setChartType('doughnut')"><svg width="42" height="22" viewBox="0 0 683 683" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <g clip-path="url(#clip0_4340_105482)">
                                <path [style.fill]="colorOfChartType==='doughnut' ? '#FFAEBC' : '#fff'"  d="M29.3329 202.667C78.2662 93.6003 180.8 17.2003 298.8 2.13361C306.4 1.06696 314.666 0.266968 317.066 0.133606L321.333 0.000305176V77.5C179.407 88.6804 73.7317 205.261 76.5 347.6C79.2182 487.362 183.155 598.664 322.666 607.467C401.558 612.445 514 541.408 514 541.408L568.666 596.134L564 600.267C525.2 633.867 474.533 659.867 423.333 672.534C358.4 688.667 286.533 684.8 224.133 661.867C193.6 650.667 155.066 628.8 128 607.467C114.4 596.667 83.8662 565.867 73.0662 551.867C51.9995 524.8 31.9995 488.934 20.6662 458.134C14.2662 440.8 6.26618 408.8 3.19952 388.667C0.266184 368.934 -0.267149 318 2.39952 298.667C6.79952 266.934 17.3329 229.467 29.3329 202.667Z" fill="white"/>
                                <path [style.fill]="colorOfChartType==='doughnut' ? '#A0E7E5' : '#fff'" d="M682.665 319.601C682.665 320.588 664.756 321.063 603.5 321.244C597.867 252.751 578.893 210.436 531.5 160.667C480.735 107.359 434.748 85.4179 361.373 79.5C361.495 5.18433 361.965 0.000640869 363.732 0.000640869C377.465 0.133972 413.465 6.40063 435.732 12.8006C555.465 46.6673 648.799 146.401 675.465 269.067C678.132 281.467 682.665 313.201 682.665 319.601Z" fill="white"/>
                                <path [style.fill]="colorOfChartType==='doughnut' ? '#FFFFAA' : '#fff'" d="M603 361.334H682.933L682 370.267C675.467 436.8 653.067 494.934 613.867 546.667C608.533 553.6 602.533 561.334 600.4 563.734L596.667 568.134L540.605 512C563.428 486.196 574.037 468.783 586.5 436.667C597.396 408.59 601.162 391.394 603 361.334Z" fill="white"/>
                                </g>
                                <defs>
                                <clipPath id="clip0_4340_105482">
                                <rect width="682.667" height="682.667" fill="white"/>
                                </clipPath>
                                </defs>
                                </svg>
                            </span>
                     </div>
                    </div>
                    <div class="chart">
                        <div style="padding-top: 6px;"></div>
                        <!-- <ng-select id="select" [(ngModel)]="selectedAttendeeUser" style="float: right; width: 250px;"
                            placeholder="choose" (change)="chooseAttendedMeetingUser()">
                            <ng-option *ngFor="let employee of employeeListAsUser"
                                value="{{employee.email}}">{{employee.firstName}} {{employee.lastName}}</ng-option>
                        </ng-select> -->
                        <canvas id="attendedMeetingListChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
        <br />
        <table class="table table-hover" *ngIf="attendedMeetingListCount > 0; else noMeetings">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Title</th>
                    <th>Organizer</th>
                    <th>Start Date & Time</th>
                    <th>End Date & Time</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let attehdedMeeting of attendedMeetingList">
                    <td>{{attehdedMeeting.meetingId}}</td>
                    <td>{{attehdedMeeting.subject}}</td>
                    <td>{{attehdedMeeting.organizerName}}</td>
                    <td>{{attehdedMeeting.startDateTime+'z'|date:'MMM d, y, h:mm a'}}</td>
                    <td>{{attehdedMeeting.endDateTime+'z'|date:'MMM d, y, h:mm a'}}</td>
                </tr>
            </tbody>
        </table>
       <ng-template #noMeetings>
        <table class="table table-hover">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Title</th>
                    <th>Organizer</th>
                    <th>Start Date & Time</th>
                    <th>End Date & Time</th>
                </tr>
            </thead>
            <tbody>
        </table>
        <p style="text-align: center;"><b>No Meetings Attended !</b></p>
       </ng-template>

    </div>
    <!-- for all Departments-->
    <div *ngIf="reportType === 'all'">
        <div class="row">
            <div>
                <ng-select id="select" [(ngModel)]="selectedDepartment" style="float: left; width: 250px; margin-left: 51px;margin-top: 9px;margin-bottom: 22px"
                placeholder="Departments" (change)="chooseDepartment()">
                <!-- <ng-option  value="all">All</ng-option> -->
                <ng-option *ngFor="let department of departmentList"
                    value="{{department.departmentId}}">{{department.departmentName}}</ng-option>
              </ng-select>
            </div>
            <br/><br/>
            <div class="col-sm-5" style="margin-left: 51px;">
                <div class="card">
                    <div class="card-header" style="background-color: #134E69D9;">
                        <h4 style="text-align: center;color: white;">Report Summary</h4>
                    </div>
                    <div style="margin-left: 30px;margin-top: 20px;">
                     <p>Report Module : <b>Meetings</b></p>
                   <!--- <p>Report Type : <b>Bar</b></p> 
                    <p>Department : <b>{{"All"}}</b></p>-->
                    <div *ngIf="selectedDepartment != null; else allMeetings">
                        <p>Department Name : <b>{{selectedDepartmentName}}</b></p>
                        <p>Total Meetings : <b>{{meetingsByDepartmentListCount}}</b></p>
                    </div>
                    <ng-template #allMeetings>
                            <p>Department Name : <b>{{"All"}}</b></p>
                            <p>Total Meetings : <b>{{OrganizedMeetingCount}}</b></p>
                       </ng-template>

                    <!-- <div *ngFor="let department of departmentList ">
                        <p>{{department.departmentName}}: {{0}}</p>
                    </div> -->
                    </div>
                </div>
            </div>
            <div class="col-sm-6">
                <div class="card">
                    <div class="card-header" id="header">
                        <h4 id="reportheading">Meetings</h4>
                        <div  class="col-sm-6" id="chartType">
                            <!-- <a style="color: white;" (click)="setChartType('pie')">Pie</a>
                            <a style="color: white;" (click)="setChartType('bar')">Bar</a>
                            <a style="color: white;" (click)="setChartType('line')">Line</a>
                            <a style="color: white;" (click)="setChartType('doughnut')">Doughnut</a> -->
                            <span  (click)="setChartType('line')"><svg width="48" height="24" viewBox="0 0 683 683" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <g clip-path="url(#clip0_4340_105478)">
                                <path [style.fill]="colorOfChartType==='line' ? '#FFFFAA' : '#fff'" d="M0 341.334V639.667C0 663.415 19.2518 682.667 43 682.667H341.333H648.667C667.444 682.667 682.667 667.445 682.667 648.667C682.667 629.889 667.444 614.667 648.667 614.667H375.333H68V307.334V34.0004C68 15.2227 52.7777 0.000305176 34 0.000305176C15.2223 0.000305176 0 15.2226 0 34.0003V341.334Z" fill="white"/>
                                <path [style.fill]="colorOfChartType==='line' ? '#A0E7E5' : '#fff'" d="M573.599 232.4L511.999 294L477.733 259.6L443.333 225.334L392.399 276.267L341.333 327.334L307.333 293.334L273.333 259.334L205.066 327.6L159.999 372.667C147.113 385.554 147.113 406.447 159.999 419.334C173.605 432.939 195.395 432.603 209.188 419.187C215.384 413.161 222.352 406.315 229.599 399.067L273.333 355.334L307.333 389.334L341.333 423.334L392.666 372L443.999 320.667L477.999 354.667L511.999 388.667L597.333 303.334L658.933 241.734C672.04 228.626 672.04 207.375 658.933 194.267C645.899 181.233 624.767 181.233 611.733 194.267L573.599 232.4Z" fill="white"/>
                                </g>
                                <defs>
                                <clipPath id="clip0_4340_105478">
                                <rect width="682.667" height="682.667" fill="white"/>
                                </clipPath>
                                </defs>
                                </svg>
                            </span>
                            <span   (click)="setChartType('bar')"><svg version="1.0" xmlns="http://www.w3.org/2000/svg"
                                width="48" height="24" viewBox="0 0 312 512.000000"
                                preserveAspectRatio="xMidYMid meet">
        
                                <g  transform="translate(0.000000,512.000000) scale(0.100000,-0.100000)"
                                fill="#000000" stroke="none">
                                <path [style.fill]="colorOfChartType==='bar' ? '#FFFFAA' : '#fff'" d="M0 2118 c0 -1342 3 -1945 11 -1972 14 -50 82 -118 135 -134 32 -9
                                585 -12 2508 -12 l2466 0 0 215 0 215 -2345 0 -2345 0 0 1810 0 1810 -215 0
                                -215 0 0 -1932z"/>
                                <path [style.fill]="colorOfChartType==='bar' ? '#FFAEBC' : '#fff'" d="M3965 4033 c-47 -24 -86 -64 -106 -108 -18 -38 -19 -105 -19 -1662
                                l0 -1623 535 0 535 0 -2 1627 -3 1628 -22 40 c-27 50 -58 80 -105 100 -56 23
                                -768 22 -813 -2z"/>
                                <path [style.fill]="colorOfChartType==='bar' ? '#B4F8C8' : '#fff'" d="M2480 3184 c-45 -20 -87 -59 -111 -106 -18 -36 -19 -76 -19 -1238 l0
                                -1200 530 0 530 0 0 1200 c0 1162 -1 1202 -19 1238 -25 48 -66 87 -113 106
                                -55 23 -745 23 -798 0z"/>
                                <path  [style.fill]="colorOfChartType==='bar' ? '#A0E7E5' : '#fff'" d="M1008 2338 c-21 -5 -58 -28 -82 -50 -79 -68 -76 -37 -76 -895 l0
                                -753 535 0 535 0 0 769 0 769 -28 53 c-20 39 -41 62 -77 84 l-48 30 -361 2
                                c-219 1 -376 -2 -398 -9z"/>
                                </g>
                                </svg>
                            </span>
                            <span  (click)="setChartType('pie')"><svg version="1.0" xmlns="http://www.w3.org/2000/svg"
                                width="42" height="22" viewBox="0 0 512.000000 512.000000"
                                preserveAspectRatio="xMidYMid meet">
                               
                               <g  transform="translate(0.000000,512.000000) scale(0.100000,-0.100000)"
                               fill="#000000" stroke="none">
                               <path [style.fill]="colorOfChartType==='pie' ? '#FFFFAA' : '#fff'" d="M2241 5104 c-885 -113 -1654 -686 -2021 -1504 -90 -201 -169 -482
                               -202 -720 -20 -145 -16 -527 6 -675 23 -151 83 -391 131 -521 85 -231 235
                               -500 393 -703 81 -105 310 -336 412 -417 203 -160 492 -324 721 -408 468 -172
                               1007 -201 1494 -80 384 95 764 290 1055 542 l35 31 -917 918 c-516 517 -922
                               930 -928 946 -7 19 -10 445 -10 1318 l0 1289 -32 -1 c-18 -1 -80 -7 -137 -15z"/>
                               <path [style.fill]="colorOfChartType==='pie' ? '#FFAEBC' : '#fff'" d="M2710 3915 l0 -1205 1205 0 c960 0 1205 3 1205 13 0 48 -34 286 -54
                               379 -200 920 -900 1668 -1798 1922 -167 48 -437 95 -540 96 -17 0 -18 -64 -18
                               -1205z"/>
                               <path [style.fill]="colorOfChartType==='pie' ? '#B4F8C8' : '#fff'" d="M3700 1635 l775 -776 28 33 c16 18 61 76 101 128 294 388 462 824
                               511 1323 l7 67 -1099 0 -1098 0 775 -775z"/>
                               </g>
                               </svg>
                            </span>
                            <span (click)="setChartType('doughnut')"><svg width="42" height="22" viewBox="0 0 683 683" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <g clip-path="url(#clip0_4340_105482)">
                                <path [style.fill]="colorOfChartType==='doughnut' ? '#FFAEBC' : '#fff'"  d="M29.3329 202.667C78.2662 93.6003 180.8 17.2003 298.8 2.13361C306.4 1.06696 314.666 0.266968 317.066 0.133606L321.333 0.000305176V77.5C179.407 88.6804 73.7317 205.261 76.5 347.6C79.2182 487.362 183.155 598.664 322.666 607.467C401.558 612.445 514 541.408 514 541.408L568.666 596.134L564 600.267C525.2 633.867 474.533 659.867 423.333 672.534C358.4 688.667 286.533 684.8 224.133 661.867C193.6 650.667 155.066 628.8 128 607.467C114.4 596.667 83.8662 565.867 73.0662 551.867C51.9995 524.8 31.9995 488.934 20.6662 458.134C14.2662 440.8 6.26618 408.8 3.19952 388.667C0.266184 368.934 -0.267149 318 2.39952 298.667C6.79952 266.934 17.3329 229.467 29.3329 202.667Z" fill="white"/>
                                <path [style.fill]="colorOfChartType==='doughnut' ? '#A0E7E5' : '#fff'" d="M682.665 319.601C682.665 320.588 664.756 321.063 603.5 321.244C597.867 252.751 578.893 210.436 531.5 160.667C480.735 107.359 434.748 85.4179 361.373 79.5C361.495 5.18433 361.965 0.000640869 363.732 0.000640869C377.465 0.133972 413.465 6.40063 435.732 12.8006C555.465 46.6673 648.799 146.401 675.465 269.067C678.132 281.467 682.665 313.201 682.665 319.601Z" fill="white"/>
                                <path [style.fill]="colorOfChartType==='doughnut' ? '#FFFFAA' : '#fff'" d="M603 361.334H682.933L682 370.267C675.467 436.8 653.067 494.934 613.867 546.667C608.533 553.6 602.533 561.334 600.4 563.734L596.667 568.134L540.605 512C563.428 486.196 574.037 468.783 586.5 436.667C597.396 408.59 601.162 391.394 603 361.334Z" fill="white"/>
                                </g>
                                <defs>
                                <clipPath id="clip0_4340_105482">
                                <rect width="682.667" height="682.667" fill="white"/>
                                </clipPath>
                                </defs>
                                </svg>
                            </span>
                     </div>
                    </div>
                    <div class="chart">
                        <div style="padding-top: 6px;"></div>
                        <canvas id="meetingsByDepartmentListChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
        <br /><br />
        <table class="table table-hover" *ngIf="selectedDepartment==null ; else noMeetings">
            <!-- <thead>
                <tr>
                    <th>ID</th>
                    <th>Title</th>
                    <th>Organizer</th>
                    <th>Department ID</th>
                    <th>Start Date Time</th>
                    <th>End Date Time</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let attendedMeeting of OrganizedMeetingList">
                    <td>{{attendedMeeting.meetingId}}</td>
                    <td>{{attendedMeeting.subject}}</td>
                    <td>{{attendedMeeting.organizerName}}</td>
                    <td>{{attendedMeeting.departmentId}}</td>
                    <td>{{attendedMeeting.startDateTime}}</td>
                    <td>{{attendedMeeting.endDateTime}}</td>
                </tr>
            </tbody> -->
             <thead>
                <tr>
                    <th>ID</th>
                    <th>Department Name</th>
                    <th>Department Head</th>
                    <th>Count of Meetings</th>
                    <!-- <th>Department Head</th>
                    <th>Total Meetings</th> -->
                </tr>
            </thead>
            <tbody>

                <tr  *ngFor="let department of deptValueCount">
                    <td>{{department.deptId}}</td>
                     <td>{{department.departmentName}}</td>
                    <td>{{department.departmentHead}}</td>
                    <td>{{department.meetingCount}}</td>

                    
                </tr>
             </tbody>

        </table>
       <ng-template #noMeetings>
        <table class="table table-hover" *ngIf="meetingsByDepartmentListCount > 0; else meetings">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Title</th>
                    <th>Organizer</th>
                    <th>Department ID</th>
                    <th>Start Date & Time</th>
                    <th>End Date & Time</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let attendedMeeting of meetingsByDepartmentList">
                        <td>{{attendedMeeting.meetingId}}</td>
                        <td>{{attendedMeeting.subject}}</td>
                        <td>{{attendedMeeting.organizerName}}</td>
                        <td>{{attendedMeeting.departmentId}}</td>
                        <td>{{attendedMeeting.startDateTime+'z'|date:'MMM d, y, h:mm a'}}</td>
                        <td>{{attendedMeeting.endDateTime+'z'|date:'MMM d, y, h:mm a'}}</td>
                    </tr>
             </tbody>
        </table>
        <!-- <p style="text-align: center;"><b>No Meetings!</b></p> -->
       </ng-template>
       <ng-template #meetings>
        <table class="table table-hover">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Title</th>
                    <th>Organizer</th>
                    <th>Department ID</th>
                    <th>Start Date & Time</th>
                    <th>End Date & Time</th>
                </tr>
            </thead>
            <tbody>
        </table>
        <p style="text-align: center;"><b>No Meetings!</b></p>
       </ng-template>
    </div>
</div>

<div class="container-fluid" *ngIf="viewPermission === false">
    <h2 style="text-align: center;margin-top: 120px;">You dont have permission to view this page</h2>
</div>
<!-- <div class="container-fluid" *ngIf="noPermissions===true">
    <h2 style="text-align: center;margin-top: 120px;">Contact admin to get access for this page</h2>
</div> -->