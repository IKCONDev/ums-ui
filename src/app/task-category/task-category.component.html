<div>
    <app-side-menubar></app-side-menubar>
</div>
<div>
    <app-header [title]="title" id="header"></app-header>
</div>
<div class="container-fluid" *ngIf="viewPermission === true">
    <div class="card-header">
        <div class="row">
            <div class="col-sm-8 d-flex">
                <h3 id="heading">Task Category</h3>
            </div>
            <div id="addBtnDiv" class="col-sm-1 d-flex">
                <button [disabled]="!createPermission" [style.background-color]="addButtonColor" class="form-control d-flex" id="addBtn" type="submit" data-toggle="modal" data-target="#addModal"
                style="width: 60px;">
                    <p>Add</p>
                </button>
            </div>
            <div id="deleteBtnDiv" class="col-sm-2 d-flex">
                <button [disabled]="!deletePermission" [style.background-color]="deleteButtonColor" type="submit" class=" form-control" id="deleteBtn" name="deleteBtn"
                (click)="removeAllSelectedTaskCategories()"  style="width: 80px;" >Delete</button>
             </div>
            <!-- <div class="col-sm-1 d-flex" id="filter">
                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none">
                    <path
                        d="M11 18H13C13.55 18 14 17.55 14 17C14 16.45 13.55 16 13 16H11C10.45 16 10 16.45 10 17C10 17.55 10.45 18 11 18ZM3 7C3 7.55 3.45 8 4 8H20C20.55 8 21 7.55 21 7C21 6.45 20.55 6 20 6H4C3.45 6 3 6.45 3 7ZM7 13H17C17.55 13 18 12.55 18 12C18 11.45 17.55 11 17 11H7C6.45 11 6 11.45 6 12C6 12.55 6.45 13 7 13Z"
                        fill="#E5EEF1" />
                </svg>
            </div> -->
        </div>
    </div>

    <div class="card-body">
        <div class="row">
            <table id="table" class="table table-hover">
                <thead id="thead">
                    <tr>
                        <th>
                            <input type="checkbox" id="mainCheckBox" (click)="checkSubCheckBoxes()" />
                        </th>
                        <th>Category ID</th>
                        <th>Category Title</th>
                        <th>Category Description</th>
                        <th>Added by</th>
                        <th>Created Date</th>
                        <th>Modified By</th>
                        <th>Modified Date</th>
                        <th>Edit</th>
                        <th>Delete</th>
                    </tr>
                </thead>
                <tbody *ngIf="isTaskCategoryDataText===false">
                    <tr class="trbody" id="dataRow" *ngFor="let category of taskCategoryList;let i = index">
                        <td>
                            <input type="checkbox" id="subCheckBox{{i}}" class="subCheckBox"
                                value="{{category.taskCategoryId}}" (click)="toggleMainCheckBox(i)" />
                        </td>
                        <!-- <td>TC{{category.taskCategoryId}}</td> -->
                        <td>{{category.taskCategoryId}}</td>
                        <td>{{category.taskCategoryTitle}}</td>
                        <td>{{category.taskCategoryDescription}}</td>
                        <td>{{category.createdBy}}</td>
                        <td>{{category.createdDateTime |date:'MMM d, y, h:mm a' }}</td>
                        <td>{{category.modifiedBy}}</td>
                        <td>{{category.modifiedDateTime |date:'MMM d, y, h:mm a'}}</td>
                        <td>
                            <button id="editIcon" [disabled]="!updatePermission" (click)="getTaskCategoryById(category.taskCategoryId)"
                                data-toggle="modal" data-target="#addModal">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20"
                                    fill="none">
                                    <g [style.fill]="updateButtonColor" id="edit">
                                        <path id="Vector"
                                            d="M2.5 14.3761V17.5007H5.62543L14.8475 8.28116L11.7221 5.15659L2.5 14.3761ZM17.2562 5.87316C17.5813 5.54821 17.5813 5.01911 17.2562 4.69416L15.3101 2.7486C14.9851 2.42364 14.4558 2.42364 14.1308 2.7486L12.6056 4.27339L15.731 7.39795L17.2562 5.87316Z"
                                             />
                                    </g>
                                </svg>
        
                            </button>
                        </td>
                        <td>
                            <button  [disabled]="!deletePermission" id="trashIcon" (click)="removeTaskCategory(category.taskCategoryId)">
                                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
                                    fill="#000000" version="1.1" id="Capa_1" width="15px" height="15px"
                                    viewBox="0 0 482.428 482.429" xml:space="preserve">
                                    <g >
                                        <g [style.fill]="deleteButtonColor">
                                            <path
                                                d="M381.163,57.799h-75.094C302.323,25.316,274.686,0,241.214,0c-33.471,0-61.104,25.315-64.85,57.799h-75.098    c-30.39,0-55.111,24.728-55.111,55.117v2.828c0,23.223,14.46,43.1,34.83,51.199v260.369c0,30.39,24.724,55.117,55.112,55.117    h210.236c30.389,0,55.111-24.729,55.111-55.117V166.944c20.369-8.1,34.83-27.977,34.83-51.199v-2.828    C436.274,82.527,411.551,57.799,381.163,57.799z M241.214,26.139c19.037,0,34.927,13.645,38.443,31.66h-76.879    C206.293,39.783,222.184,26.139,241.214,26.139z M375.305,427.312c0,15.978-13,28.979-28.973,28.979H136.096    c-15.973,0-28.973-13.002-28.973-28.979V170.861h268.182V427.312z M410.135,115.744c0,15.978-13,28.979-28.973,28.979H101.266    c-15.973,0-28.973-13.001-28.973-28.979v-2.828c0-15.978,13-28.979,28.973-28.979h279.897c15.973,0,28.973,13.001,28.973,28.979    V115.744z" />
                                            <path
                                                d="M171.144,422.863c7.218,0,13.069-5.853,13.069-13.068V262.641c0-7.216-5.852-13.07-13.069-13.07    c-7.217,0-13.069,5.854-13.069,13.07v147.154C158.074,417.012,163.926,422.863,171.144,422.863z" />
                                            <path
                                                d="M241.214,422.863c7.218,0,13.07-5.853,13.07-13.068V262.641c0-7.216-5.854-13.07-13.07-13.07    c-7.217,0-13.069,5.854-13.069,13.07v147.154C228.145,417.012,233.996,422.863,241.214,422.863z" />
                                            <path
                                                d="M311.284,422.863c7.217,0,13.068-5.853,13.068-13.068V262.641c0-7.216-5.852-13.07-13.068-13.07    c-7.219,0-13.07,5.854-13.07,13.07v147.154C298.213,417.012,304.067,422.863,311.284,422.863z" />
                                        </g>
                                    </g>
                                </svg>
                            </button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>
<div class="container-fluid" *ngIf="viewPermission===false">
    <h2 style="text-align: center;margin-top: 120px;">You dont have permission to view this page</h2>
  </div>
  <!-- <div class="container-fluid" *ngIf="noPermissions===true">
    <h2 style="text-align: center;margin-top: 120px;">Contact admin to get access for this page</h2>
</div> -->

<!-- Add Category Modal -->
<div class="modal fade" id="addModal" data-backdrop="static" data-keyboard="false" tabindex="-1" role="dialog"
    aria-labelledby="xlModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-md">
        <div class="modal-content">
            <!-- Modal Header -->
            <div class="modal-header" id="modalHeader">
                <h5 class="modal-title" id="xlModalLabel">Task category</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true" style="color:white; padding: 5px; padding-top: 0px;"
                        (click)="clearErrorMessages()">&times;</span>
                </button>
            </div>
            <!-- Modal body -->
            <div class="modal-body">
                <label><b>Task Category Name</b><span id="required">*</span></label>
                <input id="categoryName" type="text"  class="deptInput form-control" placeholder="Category Name"
                    [(ngModel)]="taskCategory.taskCategoryTitle" (keyup)="validateTaskCategoryTitle()" minlength="3"
                    maxlength="51" style="text-transform: capitalize;"/><br />
                <span *ngIf="categoryTitleErrorInfo != ''">
                    <p id="errorMessage">{{categoryTitleErrorInfo}}</p>
                </span>
                <!--   -->
                <label><b>Task Category Description</b><span id="required">*</span></label><br/>
                <textarea id="categoryDesc" class="form-control" placeholder="Category Description"
                    [(ngModel)]="taskCategory.taskCategoryDescription" (keyup)="validateTaskCategoryDescription()"  minlength="5" maxlength="101"
                    rows="5" cols="10" style="width: 400px;">
                </textarea><br />
                <span *ngIf="categoryDescErrorInfo != ''">
                    <p id="errorMessage">{{categoryDescErrorInfo}}</p>
                </span>
                <!--  -->
            </div>
            <!-- Modal footer -->
            <div class="modal-footer" role="alert">
                <button type="submit" class="btn btn-primary saveButton" (click)="createOrUpdateTaskCategory()">Save</button>
                <!-- <button type="button" class="btn btn-secondary" data-dismiss="modal"
                        (click)=" clearErrorMessages(form)">Close</button> -->
                <button type="button" id="closeModal" class="btn btn-outline-danger closeButton" data-dismiss="modal"
                    (click)="clearErrorMessages()">Close</button>
            </div>
        </div>
    </div>
</div>
<div *ngIf="isComponentLoading===true"  style="padding-top:140px;color: #134E69D9;">
    <!-- <span *ngIf="isComponentLoading===true">
        <div class="spinner-border" style="width: 4rem; height: 4rem;animation-duration:1s" role="status">
            <span class="sr-only">Loading...</span>
             <div style="position: fixed;padding-top: 16px;padding-left: 8px;"><h5>UMS</h5></div>
        </div>
    </span>-->   
    <div style="padding-left: 50%;">
        <div class="loader" style="color: #2AA3D9;"></div> 
            <svg xmlns="http://www.w3.org/2000/svg" width="50" height="35" viewBox="0 0 315 103" fill="none" style="margin-left:-7px">
                <path d="M70.7305 1.88965H99.9988V53.726H70.7305V31.2772V1.88965Z" fill="url(#paint0_linear_354_164515)"/>
                <path d="M99.9905 54.5423V1.88965L29.2588 73.7258C24.3834 88.0114 49.998 101.481 60.5596 101.481C93.9306 101.481 100.261 66.515 99.9905 54.5423Z" fill="url(#paint1_linear_354_164515)"/>
                <path d="M0 53.3168V1.48131C20.3252 5.15471 30.4878 12.0918 30.4878 53.3168C30.4878 94.5417 50.1355 100.664 60.1626 101.48C12.3577 101.48 0 77.3982 0 53.3168Z" fill="#30D64B"/>
                <path d="M118.575 101.53C117.622 101.53 116.764 101.196 116.001 100.529C115.334 99.8614 115 99.0034 115 97.9547V5.00469C115 3.95602 115.334 3.09802 116.001 2.43069C116.764 1.76335 117.622 1.42969 118.575 1.42969H134.019C135.544 1.42969 136.688 1.85868 137.451 2.71668C138.309 3.47935 138.833 4.09902 139.024 4.57569L164.192 49.7637L189.36 4.57569C189.646 4.09902 190.123 3.47935 190.79 2.71668C191.553 1.85868 192.744 1.42969 194.365 1.42969H209.666C210.715 1.42969 211.573 1.76335 212.24 2.43069C213.003 3.09802 213.384 3.95602 213.384 5.00469V97.9547C213.384 99.0034 213.003 99.8614 212.24 100.529C211.573 101.196 210.715 101.53 209.666 101.53H192.649C191.6 101.53 190.695 101.196 189.932 100.529C189.265 99.8614 188.931 99.0034 188.931 97.9547V44.3297L172.772 74.2167C172.391 75.0747 171.819 75.8374 171.056 76.5047C170.293 77.172 169.245 77.5057 167.91 77.5057H160.474C159.139 77.5057 158.091 77.172 157.328 76.5047C156.565 75.8374 155.946 75.0747 155.469 74.2167L139.31 44.3297V97.9547C139.31 99.0034 138.976 99.8614 138.309 100.529C137.642 101.196 136.784 101.53 135.735 101.53H118.575Z" fill="#2AA3D9"/>
                <path d="M271.569 102.96C262.036 102.96 254.123 101.625 247.831 98.956C241.539 96.1913 236.772 92.6163 233.531 88.231C230.289 83.8457 228.573 79.1743 228.383 74.217C228.383 73.4543 228.669 72.787 229.241 72.215C229.908 71.5477 230.671 71.214 231.529 71.214H249.547C250.882 71.214 251.883 71.4523 252.55 71.929C253.313 72.4057 253.98 73.0253 254.552 73.788C255.315 75.218 256.363 76.6003 257.698 77.935C259.128 79.2697 260.939 80.366 263.132 81.224C265.42 81.9867 268.232 82.368 271.569 82.368C277.098 82.368 281.245 81.51 284.01 79.794C286.87 78.078 288.3 75.7423 288.3 72.787C288.3 70.6897 287.537 68.9737 286.012 67.639C284.487 66.209 282.008 64.9697 278.576 63.921C275.239 62.777 270.759 61.633 265.134 60.489C257.889 58.9637 251.692 57.0093 246.544 54.626C241.491 52.1473 237.63 48.9537 234.961 45.045C232.291 41.041 230.957 36.0837 230.957 30.173C230.957 24.3577 232.577 19.162 235.819 14.586C239.156 10.01 243.779 6.435 249.69 3.861C255.601 1.287 262.608 0 270.711 0C277.289 0 283.057 0.857995 288.014 2.574C293.067 4.29 297.309 6.57801 300.741 9.438C304.173 12.298 306.747 15.3487 308.463 18.59C310.274 21.736 311.228 24.8343 311.323 27.885C311.323 28.6477 311.037 29.3627 310.465 30.03C309.893 30.602 309.178 30.888 308.32 30.888H289.444C288.395 30.888 287.49 30.6973 286.727 30.316C285.964 29.9347 285.297 29.315 284.725 28.457C284.153 26.3597 282.628 24.5483 280.149 23.023C277.766 21.4023 274.62 20.592 270.711 20.592C266.516 20.592 263.227 21.3547 260.844 22.88C258.556 24.31 257.412 26.5503 257.412 29.601C257.412 31.5077 258.032 33.176 259.271 34.606C260.606 36.036 262.751 37.2753 265.706 38.324C268.757 39.3727 272.904 40.469 278.147 41.613C286.822 43.2337 293.829 45.2833 299.168 47.762C304.507 50.1453 308.415 53.2913 310.894 57.2C313.373 61.0133 314.612 65.8277 314.612 71.643C314.612 78.1257 312.753 83.7503 309.035 88.517C305.412 93.1883 300.36 96.7633 293.877 99.242C287.394 101.721 279.958 102.96 271.569 102.96Z" fill="#2AA3D9"/>
                <defs>
                <linearGradient id="paint0_linear_354_164515" x1="85.3646" y1="1.88965" x2="85.3646" y2="74.1332" gradientUnits="userSpaceOnUse">
                <stop stop-color="#2AA3D9"/>
                <stop offset="1"/>
                </linearGradient>
                <linearGradient id="paint1_linear_354_164515" x1="59.3489" y1="68.8271" x2="-58.8583" y2="152.454" gradientUnits="userSpaceOnUse">
                <stop stop-color="#2AA3D9"/>
                <stop offset="1"/>
                </linearGradient>
                </defs>
                <!-- Animation -->
                <animate attributeName="opacity" attributeType="XML" values="0.4;1.4;0.4" dur="1.5s" repeatCount="indefinite" />
            </svg>
    </div>      
</div>


